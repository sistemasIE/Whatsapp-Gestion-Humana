import{a as b}from"./chunk-OC6YCXVP.js";import{g as $,h as w,j as T,l as f,x as g}from"./chunk-YPUWGHW6.js";import{a as s}from"./chunk-ARVTP27M.js";import{Da as u,Ia as _,Oa as m,Qa as o,Ra as i,Sa as E,Ta as y,Wa as v,X as D,Xa as h,Y as S,Ya as n,_a as d,fb as I,gb as M,ua as a,za as p}from"./chunk-N26TRWMU.js";var C=class c{constructor(t){this.http=t;this.cargar()}nombreDocumento="";mensaje="";error="";documentos=[];mostrarModal=!1;cargar(){this.http.get(`${s.API_URL}/tipo-documento`).subscribe({next:t=>this.documentos=t.data,error:()=>this.error="Error al cargar los documentos"})}agregar(){if(this.mensaje="",this.error="",!this.nombreDocumento.trim()){this.error="El nombre del documento es obligatorio";return}this.http.post(`${s.API_URL}/tipo-documento`,{nombreDocumento:this.nombreDocumento}).subscribe({next:()=>{this.mensaje="Tipo de documento agregado correctamente",this.nombreDocumento="",this.cargar()},error:()=>this.error="Error al agregar el documento"})}eliminar(t){confirm("\xBFSeguro que quieres eliminar este tipo de documento?")&&this.http.delete(`${s.API_URL}/tipo-documento/${t}`).subscribe({next:()=>{this.mensaje="Eliminado correctamente",this.cargar()},error:()=>this.error="Error al eliminar"})}abrirModal(){this.mostrarModal?this.mostrarModal=!1:this.mostrarModal=!0}static \u0275fac=function(e){return new(e||c)(p(b))};static \u0275cmp=u({type:c,selectors:[["app-tipo-documento"]],decls:0,vars:0,template:function(e,r){},dependencies:[g,f],encapsulation:2})};function N(c,t){if(c&1){let e=y();o(0,"tr")(1,"td")(2,"p",6),n(3),I(4,"date"),i()(),o(5,"td")(6,"p",6),n(7),i()(),o(8,"td")(9,"p",6),n(10),i()(),o(11,"td")(12,"p",6),n(13),i()(),o(14,"td")(15,"p",6),n(16),i()(),o(17,"td")(18,"button",7),v("click",function(){let l=D(e).$implicit,x=h();return S(x.aceptar(l.idSolicDoc))}),n(19," Aceptar "),i(),o(20,"button",8),v("click",function(){let l=D(e).$implicit,x=h();return S(x.rechazar(l.idSolicDoc))}),n(21," Rechazar "),i()()()}if(c&2){let e=t.$implicit,r=h();a(2),m("ngClass",r.getColorClass(e.fechaSolicitud)),a(),d(" ",M(4,10,e.fechaSolicitud,"shortDate")," "),a(3),m("ngClass",r.getColorClass(e.fechaSolicitud)),a(),d(" ",e.nombreDocumento," "),a(2),m("ngClass",r.getColorClass(e.fechaSolicitud)),a(),d(" ",e.nombreEmpleado," "),a(2),m("ngClass",r.getColorClass(e.fechaSolicitud)),a(),d(" ",e.numeroDeCedula," "),a(2),m("ngClass",r.getColorClass(e.fechaSolicitud)),a(),d(" ",e.correoElectronico," ")}}var F=class c{constructor(t){this.http=t}solicitudes=[];ngOnInit(){this.cargarSolicitudes()}cargarSolicitudes(){this.http.get(`${s.API_URL}/solicitar-documento`).subscribe({next:t=>{this.solicitudes=t.data.sort((e,r)=>new Date(e.fechaSolicitud).getTime()-new Date(r.fechaSolicitud).getTime())},error:()=>{alert("Error cargando solicitudes")}})}getColorClass(t){let e=new Date,r=new Date(t),l=Math.floor((+e-+r)/(1e3*60*60*24));return l<1?"text-success":l<2?"text-primary":"text-danger"}aceptar(t){this.http.put(`${s.API_URL}/solicitar-documento/${t}`,{revisado:1}).subscribe({next:()=>{this.solicitudes=this.solicitudes.filter(e=>e.id!==t),this.cargarSolicitudes()},error:()=>{alert("Error aceptando la solicitud")}})}rechazar(t){this.http.delete(`${s.API_URL}/solicitar-documento/${t}`).subscribe({next:()=>{this.cargarSolicitudes()},error:()=>{alert("Error rechazando la solicitud")}}),alert(`Solicitud ${t} rechazada`)}static \u0275fac=function(e){return new(e||c)(p(b))};static \u0275cmp=u({type:c,selectors:[["app-documents"]],decls:22,vars:1,consts:[[1,"container","mt-4"],[1,"underline"],[1,"table-responsive","shadow"],[1,"table","table-hover","table-bordered","align-middle"],[1,"table-dark"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btn","btn-success","btn-sm","me-2",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,r){e&1&&(E(0,"app-tipo-documento"),o(1,"div",0)(2,"h3",1),n(3,"\u{1F4C4}Documentos Solicitados"),i(),o(4,"div",2)(5,"table",3)(6,"thead",4)(7,"tr")(8,"th"),n(9,"Fecha"),i(),o(10,"th"),n(11,"Documento"),i(),o(12,"th"),n(13,"Nombre"),i(),o(14,"th"),n(15,"C\xE9dula"),i(),o(16,"th"),n(17,"Correo"),i(),o(18,"th"),n(19,"Acciones"),i()()(),o(20,"tbody"),_(21,N,22,13,"tr",5),i()()()()),e&2&&(a(21),m("ngForOf",r.solicitudes))},dependencies:[C,f,$,w,T,g],encapsulation:2})};export{F as DocumentsComponent};
